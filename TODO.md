TODO
- Replace some Func stuff with interfaces, so we can use proper dependency injection
- Refactor ParseResult and ProcessResult to use the regular Result class